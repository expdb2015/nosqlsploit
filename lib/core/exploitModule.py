'''
'''
from prettyPrint import *
from prettyPrint import prettyPrint as pp
from os import listdir,getcwd,linesep,system
from socket import *
from mongodbModule import *
import urllib
import urllib2
import subprocess
import pymongo
import gridfs
import ipcalc
import cookielib
import re,sys,hashlib
import threading,time
import MultipartPostHandler

class exploitModule:

    ''' all plugins function'''
    def checkPort(self,host,port):
        '''check host's port !open?::return 1 or 0'''
        try:
            s = socket(AF_INET,SOCK_STREAM)
            s.settimeout(5)
            s.connect((host ,int(port)))
            s.close()
            return 1
        except:
            return 0

    def urlGET(self,url):
        '''url open=>get'''
        return urllib.urlopen(url)
    
    def urlPOST(self,url,value):
        '''url post'''
        print url
        data    = urllib.urlencode(value)
        headers = { 'User-Agent' : 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11' }
        res     = urllib2.Request(url,data,headers)
        try:
            ok  = urllib2.urlopen(res)
            return ok
        except:
            return 0

    def urlUpload(self ,url ,value):
        '''url upload file'''
        cookies = cookielib.CookieJar()
        opener  = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookies) ,MultipartPostHandler.MultipartPostHandler)
        opener.open(url ,value)

    def urlToIp(self,url):
        '''url to ip'''
        return gethostbyname(url)

    def writeLog(self,logname,log):
        '''write log to file'''
        fp = open('output/%s.log'%logname,'w+')
        fp.writelines(log)
        fp.close()
    
    def find(self,r,t):
        '''re find'''
        return re.findall(r,t)
		
if __name__ == '__main__':
    print __doc__
